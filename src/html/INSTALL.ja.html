<?xml version="1.0" encoding="euc-jp" ?>
<!DOCTYPE html 
  PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="ja" xml:lang="ja">
<head>
<title>RubyCocoa - INSTALL</title>
<meta http-equiv="Content-type" content="text/html; charset=euc-jp" />
<link href="rdtext.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1><a name="label:0" id="label:0">RubyCocoaのインストール</a></h1><!-- RDLabel: "RubyCocoaのインストール" -->
<h2><a name="label:1" id="label:1">インストールのおおまかな手順</a></h2><!-- RDLabel: "インストールのおおまかな手順" -->
<ul>
<li>Ruby 1.6.5のインストール</li>
<li>RubyCocoaの展開</li>
<li>LibRubyフレームワークのインストール</li>
<li>RubyCocoaの構築とインストール</li>
<li>インストール完了</li>
<li>サンプルの動作確認</li>
</ul>
<p>インストールはTerminalアプリケーションなどでシェルからコマンド入力して
行います。</p>
<h2><a name="label:2" id="label:2">Ruby 1.6.5のインストール</a></h2><!-- RDLabel: "Ruby 1.6.5のインストール" -->
<p>すでにRuby-1.6.5を"--enable-shared"オプション付きでインストールしてい
る場合は読み飛ばしてください。</p>
<p>MacOS X 10.1で バージョン1.6.5以前のRubyを作る場合、以下のようにRubyの
ソースにパッチをあてる必要があります。</p>
<pre>% cd {どこか}
% tar zxf ruby-1.6.5.tar.gz
% cd ruby-1.6.5
% patch -p1 &lt; {RubyCocoaソースディレクトリ}/misc/ruby-osx10_1.patch</pre>
<p>あとは普通にインストールします。configure時には"--enable-shared"オプショ
ンを指定することをお勧めします。なしの場合に動作するかはまったく未確認
です。</p>
<pre>% cd {ruby-1.6.5ソースディレクトリ}
% ./configure --enable-shared  # /usr/local にインストール
% make ; make test
% sudo make install</pre>
<h2><a name="label:3" id="label:3">RubyCocoaの展開</a></h2><!-- RDLabel: "RubyCocoaの展開" -->
<p>RubyCocoaソースのtarballを展開します。</p>
<pre>% cd {どこか}
% tar zxf rubycocoa-0.1.0.tgz</pre>
<p><em>注意</em> StuffItを使うとファイル名の長さの問題でRubyCocoaが正しくイ
ンストールされないのでtarコマンドを使ってください。</p>
<h2><a name="label:4" id="label:4">LibRubyフレームワークのインストール</a></h2><!-- RDLabel: "LibRubyフレームワークのインストール" -->
<p>LibRubyフレームワークは、すでにインストールされているRubyインタープリ
タの共有ライブラリやヘッダファイルに、シンボリックリンクを張ったりコピー
したりしてフレームワーク化したものです。RubyCocoaの構築やRubyCocoaのア
プリケーションの構築実行にはこのフレームワークを必要とします。以下の手
順で"/Library/Frameworks"の下にLibRubyフレームワークをインストールしま
す。</p>
<pre>% cd {RubyCocoaソースディレクトリ}
% ruby tool/install-libruby-frmwk.rb</pre>
<p>フレームワークを作る場所を変えたい場合は</p>
<pre>% ruby tool/install-libruby-frmwk.rb {フレームワークスディレクトリ}</pre>
<p>のように引数にディレクトリを指定してスクリプトを起動してください。</p>
<h2><a name="label:5" id="label:5">RubyCocoaの構築とインストール</a></h2><!-- RDLabel: "RubyCocoaの構築とインストール" -->
<p>RubyCocoa本体を構成するライブラリ群とRubyCocoaフレームワークを構築イン
ストールします。</p>
<p>RubyCocoaのソースディレクトリに移動し以下のように入力します。</p>
<pre>% cd {RubyCocoaソースディレクトリ}
% ruby install.rb config
% ruby install.rb setup
% sudo ruby install.rb install</pre>
<p>LibRubyがインストールされていない場合、configのあと前述のLibRubyフレー
ムワークが必要だよというメッセージが表示されますので、先にLibRubyを上
記手順でインストールしてください。</p>
<p>setupは時間がかかります。お茶でもしながら待ちましょう。</p>
<p>installではRubyCocoaライブラリの他に、RubyCocoaフレームワークを
"/Library/Frameworks"以下にインストールします。</p>
<h2><a name="label:6" id="label:6">インストール完了</a></h2><!-- RDLabel: "インストール完了" -->
<p>以上でインストールは完了です。ここまでの手順でRuby自体の他に</p>
<ul>
<li>LibRubyフレームワーク   - /Library/Frameworks/LibRuby.framework</li>
<li>RubyCocoaフレームワーク - /Library/Frameworks/RubyCocoa.framework</li>
<li>RubyCocoaライブラリA    - {site_ruby}/1.6/{archdir}/osxobjc.bundle</li>
<li>RubyCocoaライブラリB    - {site_ruby}/1.6/osx/*.rb</li>
</ul>
<p>がインストールされました。</p>
<h2><a name="label:7" id="label:7">サンプルの動作確認</a></h2><!-- RDLabel: "サンプルの動作確認" -->
<p>サンプルディレクトリに移動して簡単なスクリプトを実行してみましょう。</p>
<pre>% cd {RubyCocoaソースディレクトリ}/sample
% ruby fontnames.rb  # フォント名がずらずらと出力されます
% ruby sndplay.rb    # システムの警告音が順番に鳴ります
% ruby sndplay2.rb   # システムの警告音が順番に間隔を詰めて鳴ります</pre>
<p>うまく動作したでしょうか？うまくいったら次にRubyCocaアプリケーションを
動かしてみましょう。まずはすでに完成しているものを動かしてみましょう。</p>
<pre>% cd {RubyCocoaソースディレクトリ}/sample
% open SimpleApp1.app</pre>
<p>次にMakefileベースのものを試してみましょう。</p>
<pre>% cd {RubyCocoaソースディレクトリ}/sample/mk_app1
% make</pre>
<p>で構築します。できたら実行してみましょう。そのままコマンドラインから</p>
<pre>% open SimpleApp1.app</pre>
<p>と入力するか、ファインダで SimpleApp1 をダブルクリックして起動してみて
ください。動きましたか。次にProject Builderベースのものを試してみましょ
う。コマンドラインから</p>
<pre>% cd {RubyCocoaソースディレクトリ}/sample/pb_app1
% pbxbuild      # アプリケーション作成</pre>
<p>として構築します。もちろん Project Builder を起動してその中で構築した
り実行したりすることもできます。実行してみましょう。</p>
<pre>% open build/pb_app1.app</pre>
<p>と打ち込むか、またはファインダでbuildディレクトリの中のpb_app1をダブル
クリックしてアプリケーションを起動してみてください。うまく動きましたか？</p>
<h2><a name="label:8" id="label:8">開発動作確認環境</a></h2><!-- RDLabel: "開発動作確認環境" -->
<p>以下の環境で開発動作確認をしています。</p>
<ul>
<li>PowerMacintosh G4/400/320MB</li>
<li>MacOS X 10.1.1 (or 10.1)</li>
<li>DevTools 10.1</li>
<li>ruby-1.6.5 (configure --enable-shared)</li>
</ul>
<h2><a name="label:9" id="label:9">ではお楽しみください</a></h2><!-- RDLabel: "ではお楽しみください" -->
<p>感想、アイデア、提案、疑問、質問などなんでも気軽に教えてください。</p>
<p>藤本尚邦 &lt;hisa@imasy.or.jp&gt;
$Date$ $Revision$</p>

</body>
</html>
